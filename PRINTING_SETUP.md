# üñ®Ô∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–µ—á–∞—Ç–∏

## –ë—ã—Å—Ç—Ä–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞

### 1. –ü—Ä–æ—Å–º–æ—Ç—Ä –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –ø—Ä–∏–Ω—Ç–µ—Ä–æ–≤

–ó–∞–ø—É—Å—Ç–∏—Ç–µ —É—Ç–∏–ª–∏—Ç—É –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –ø—Ä–∏–Ω—Ç–µ—Ä–æ–≤:

```bash
python list_printers.py
```

–í—ã —É–≤–∏–¥–∏—Ç–µ —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –ø—Ä–∏–Ω—Ç–µ—Ä–æ–≤ –≤ —Å–∏—Å—Ç–µ–º–µ –∏ –ø—Ä–∏–Ω—Ç–µ—Ä –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é.

### 2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ .env —Ñ–∞–π–ª–∞

–û—Ç–∫—Ä–æ–π—Ç–µ —Ñ–∞–π–ª `.env` –∏ –Ω–∞—Å—Ç—Ä–æ–π—Ç–µ:

```bash
# –í–∫–ª—é—á–∏—Ç—å –ø–µ—á–∞—Ç—å
ENABLE_PRINTING=true

# –í—ã–±—Ä–∞—Ç—å –ø—Ä–∏–Ω—Ç–µ—Ä (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)
PRINTER_NAME=               # –û—Å—Ç–∞–≤—å—Ç–µ –ø—É—Å—Ç—ã–º –¥–ª—è –ø—Ä–∏–Ω—Ç–µ—Ä–∞ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
# –∏–ª–∏
PRINTER_NAME=HP_LaserJet    # –£–∫–∞–∂–∏—Ç–µ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π –ø—Ä–∏–Ω—Ç–µ—Ä
```

### 3. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ —Å–µ—Ä–≤–µ—Ä

```bash
# –û—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ —Å–µ—Ä–≤–µ—Ä (Ctrl+C)
# –ó–∞–ø—É—Å—Ç–∏—Ç–µ –∑–∞–Ω–æ–≤–æ
python app.py
```

---

## –ü–æ–¥—Ä–æ–±–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –¥–ª—è Raspberry Pi

### –£—Å—Ç–∞–Ω–æ–≤–∫–∞ CUPS (–µ—Å–ª–∏ –µ—â–µ –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω)

```bash
sudo apt-get update
sudo apt-get install cups
```

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ –≥—Ä—É–ø–ø—É lpadmin

```bash
sudo usermod -a -G lpadmin $USER
sudo usermod -a -G lpadmin pi
```

**–í–∞–∂–Ω–æ:** –ü–æ—Å–ª–µ —ç—Ç–æ–≥–æ –Ω—É–∂–Ω–æ –≤—ã–π—Ç–∏ –∏ –≤–æ–π—Ç–∏ –∑–∞–Ω–æ–≤–æ, –∏–ª–∏ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç—å Raspberry Pi.

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ CUPS —á–µ—Ä–µ–∑ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å

1. –û—Ç–∫—Ä–æ–π—Ç–µ –±—Ä–∞—É–∑–µ—Ä –Ω–∞ Raspberry Pi:
   ```
   http://localhost:631
   ```

2. –ò–ª–∏ —Å –¥—Ä—É–≥–æ–≥–æ –∫–æ–º–ø—å—é—Ç–µ—Ä–∞ –≤ —Å–µ—Ç–∏:
   ```
   http://raspberry-pi-ip:631
   ```

3. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ **Administration** ‚Üí **Add Printer**

4. –í—ã–±–µ—Ä–∏—Ç–µ –≤–∞—à –ø—Ä–∏–Ω—Ç–µ—Ä –∏–∑ —Å–ø–∏—Å–∫–∞

5. –°–ª–µ–¥—É–π—Ç–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º –º–∞—Å—Ç–µ—Ä–∞ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∏–Ω—Ç–µ—Ä–æ–≤

```bash
# –ü–æ–∫–∞–∑–∞—Ç—å –≤—Å–µ –ø—Ä–∏–Ω—Ç–µ—Ä—ã
lpstat -p -d

# –ü–æ–∫–∞–∑–∞—Ç—å –ø—Ä–∏–Ω—Ç–µ—Ä –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
lpstat -d

# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø—Ä–∏–Ω—Ç–µ—Ä –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
lpoptions -d printer_name
```

### –¢–µ—Å—Ç–æ–≤–∞—è –ø–µ—á–∞—Ç—å

–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –≤—Å—Ç—Ä–æ–µ–Ω–Ω—É—é —É—Ç–∏–ª–∏—Ç—É:

```bash
# –ü–µ—á–∞—Ç—å –Ω–∞ –ø—Ä–∏–Ω—Ç–µ—Ä –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
python list_printers.py --test

# –ü–µ—á–∞—Ç—å –Ω–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π –ø—Ä–∏–Ω—Ç–µ—Ä
python list_printers.py --test HP_LaserJet
```

–ò–ª–∏ –Ω–∞–ø—Ä—è–º—É—é —á–µ—Ä–µ–∑ CUPS:

```bash
# –¢–µ—Å—Ç–æ–≤–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –Ω–∞ –ø—Ä–∏–Ω—Ç–µ—Ä –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
lp /usr/share/cups/data/testprint

# –¢–µ—Å—Ç–æ–≤–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –Ω–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π –ø—Ä–∏–Ω—Ç–µ—Ä
lp -d HP_LaserJet /usr/share/cups/data/testprint
```

---

## –†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

### –û—à–∏–±–∫–∞ "lp command not found"

CUPS –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ:
```bash
sudo apt-get install cups
```

### –ü—Ä–∏–Ω—Ç–µ—Ä –Ω–µ –Ω–∞–π–¥–µ–Ω

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –ø—Ä–∏–Ω—Ç–µ—Ä–∞:
   ```bash
   lpstat -p
   ```

2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ CUPS –∑–∞–ø—É—â–µ–Ω:
   ```bash
   sudo systemctl status cups
   ```

3. –ï—Å–ª–∏ –Ω–µ –∑–∞–ø—É—â–µ–Ω, –∑–∞–ø—É—Å—Ç–∏—Ç–µ:
   ```bash
   sudo systemctl start cups
   sudo systemctl enable cups
   ```

### –ü—Ä–∏–Ω—Ç–µ—Ä –Ω–µ –ø–µ—á–∞—Ç–∞–µ—Ç

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –æ—á–µ—Ä–µ–¥—å –ø–µ—á–∞—Ç–∏:
   ```bash
   lpstat -o
   ```

2. –û—á–∏—Å—Ç–∏—Ç–µ –æ—á–µ—Ä–µ–¥—å, –µ—Å–ª–∏ –µ—Å—Ç—å –∑–∞—Å—Ç—Ä—è–≤—à–∏–µ –∑–∞–¥–∞–Ω–∏—è:
   ```bash
   cancel -a
   ```

3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç–∞—Ç—É—Å –ø—Ä–∏–Ω—Ç–µ—Ä–∞:
   ```bash
   lpstat -p printer_name
   ```

4. –ï—Å–ª–∏ –ø—Ä–∏–Ω—Ç–µ—Ä –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω, –∑–∞–ø—É—Å—Ç–∏—Ç–µ:
   ```bash
   cupsenable printer_name
   ```

### –û—à–∏–±–∫–∞ "Forbidden" –≤ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ CUPS

–û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ `/etc/cups/cupsd.conf`:

```bash
sudo nano /etc/cups/cupsd.conf
```

–ù–∞–π–¥–∏—Ç–µ —Å–µ–∫—Ü–∏—é –∏ –∏–∑–º–µ–Ω–∏—Ç–µ:

```
# –†–∞–∑—Ä–µ—à–∏—Ç—å –¥–æ—Å—Ç—É–ø –∏–∑ –ª–æ–∫–∞–ª—å–Ω–æ–π —Å–µ—Ç–∏
<Location />
  Order allow,deny
  Allow @LOCAL
</Location>

<Location /admin>
  Order allow,deny
  Allow @LOCAL
</Location>
```

–ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ CUPS:
```bash
sudo systemctl restart cups
```

### –ü—Ä–∏–Ω—Ç–µ—Ä –ø–µ—á–∞—Ç–∞–µ—Ç, –Ω–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –Ω–µ –ø–æ–º–µ—â–∞–µ—Ç—Å—è

–ù–∞—Å—Ç—Ä–æ–π—Ç–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–µ—á–∞—Ç–∏ –≤ `.env`:

```bash
# –ú–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –æ–ø—Ü–∏–∏ lp
PRINTER_OPTIONS=-o fit-to-page
```

–ò –º–æ–¥–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å –∫–æ–º–∞–Ω–¥—É –ø–µ—á–∞—Ç–∏ –≤ `app.py`:

```python
cmd = ['lp', '-d', Config.PRINTER_NAME, '-o', 'fit-to-page', filepath]
```

---

## –ü–æ–ø—É–ª—è—Ä–Ω—ã–µ –ø—Ä–∏–Ω—Ç–µ—Ä—ã –¥–ª—è Raspberry Pi

### USB –ø—Ä–∏–Ω—Ç–µ—Ä—ã
- **Brother** - –æ–±—ã—á–Ω–æ —Ä–∞–±–æ—Ç–∞—é—Ç "–∏–∑ –∫–æ—Ä–æ–±–∫–∏"
- **HP** - —Ö–æ—Ä–æ—à–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞ —á–µ—Ä–µ–∑ HPLIP
- **Canon** - —Ç—Ä–µ–±—É—é—Ç —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –¥—Ä–∞–π–≤–µ—Ä–æ–≤

### –°–µ—Ç–µ–≤—ã–µ –ø—Ä–∏–Ω—Ç–µ—Ä—ã
–î–æ–±–∞–≤—å—Ç–µ —á–µ—Ä–µ–∑ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å CUPS –ø–æ IP –∞–¥—Ä–µ—Å—É

### –¢–µ—Ä–º–æ–ø—Ä–∏–Ω—Ç–µ—Ä—ã (—á–µ–∫–∏)
–ò–¥–µ–∞–ª—å–Ω–æ –¥–ª—è —Ä–∞—Å–∫—Ä–∞—Å–æ–∫ —Ñ–æ—Ä–º–∞—Ç–∞ 80–º–º:
- **Epson TM-T20**
- **Star TSP100**
- **–ö–∏—Ç–∞–π—Å–∫–∏–µ —Ç–µ—Ä–º–æ–ø—Ä–∏–Ω—Ç–µ—Ä—ã** (–æ–±—ã—á–Ω–æ —Å–æ–≤–º–µ—Å—Ç–∏–º—ã —Å ESC/POS)

---

## –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Ç–µ—Ä–º–æ–ø—Ä–∏–Ω—Ç–µ—Ä–∞

–î–ª—è —Ç–µ—Ä–º–æ–ø—Ä–∏–Ω—Ç–µ—Ä–æ–≤ —á–∞—Å—Ç–æ –Ω—É–∂–Ω—ã —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏:

```bash
# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –¥—Ä–∞–π–≤–µ—Ä–æ–≤ ESC/POS
sudo apt-get install printer-driver-escpr

# –ü–µ—á–∞—Ç—å –Ω–∞ —Ç–µ—Ä–º–æ–ø—Ä–∏–Ω—Ç–µ—Ä —Å –æ–±—Ä–µ–∑–∫–æ–π
lp -d ThermalPrinter -o media=Custom.80x200mm filepath.png
```

---

## –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø–µ—á–∞—Ç—å –ø—Ä–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–∏ USB

–°–æ–∑–¥–∞–π—Ç–µ udev –ø—Ä–∞–≤–∏–ª–æ:

```bash
sudo nano /etc/udev/rules.d/99-printer.rules
```

–î–æ–±–∞–≤—å—Ç–µ:
```
ACTION=="add", SUBSYSTEM=="usb", ATTR{idVendor}=="04b8", ATTR{idProduct}=="0202", RUN+="/usr/local/bin/setup-printer.sh"
```

–ì–¥–µ `04b8:0202` - —ç—Ç–æ vendor:product ID –≤–∞—à–µ–≥–æ –ø—Ä–∏–Ω—Ç–µ—Ä–∞ (–Ω–∞–π–¥–∏—Ç–µ —á–µ—Ä–µ–∑ `lsusb`).

---

## –ü–æ–ª–µ–∑–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã

```bash
# –ü–æ–∫–∞–∑–∞—Ç—å –≤—Å–µ –ø—Ä–∏–Ω—Ç–µ—Ä—ã –∏ –∏—Ö —Å—Ç–∞—Ç—É—Å—ã
lpstat -p -d

# –ü–æ–∫–∞–∑–∞—Ç—å –æ—á–µ—Ä–µ–¥—å –ø–µ—á–∞—Ç–∏
lpstat -o

# –û—Ç–º–µ–Ω–∏—Ç—å –≤—Å–µ –∑–∞–¥–∞–Ω–∏—è –ø–µ—á–∞—Ç–∏
cancel -a

# –û—Ç–º–µ–Ω–∏—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–µ –∑–∞–¥–∞–Ω–∏–µ
cancel job-id

# –ü–æ–∫–∞–∑–∞—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø—Ä–∏–Ω—Ç–µ—Ä–µ
lpoptions -p printer_name -l

# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø—Ä–∏–Ω—Ç–µ—Ä –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
lpoptions -d printer_name

# –ü–æ–∫–∞–∑–∞—Ç—å –¥—Ä–∞–π–≤–µ—Ä—ã
lpinfo -m

# –ü–æ–∫–∞–∑–∞—Ç—å –ø–æ–¥–∫–ª—é—á–µ–Ω–Ω—ã–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞
lpinfo -v
```

---

## –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

### –†–∞–∑–º–µ—Ä –±—É–º–∞–≥–∏

–í `.env` –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å:
```bash
PAPER_SIZE=A4           # –∏–ª–∏ Letter, Legal, Custom
```

### –ö–∞—á–µ—Å—Ç–≤–æ –ø–µ—á–∞—Ç–∏

```bash
PRINT_QUALITY=high      # low, normal, high
```

### –û—Ä–∏–µ–Ω—Ç–∞—Ü–∏—è

```bash
PRINT_ORIENTATION=portrait   # –∏–ª–∏ landscape
```

---

–ï—Å–ª–∏ —á—Ç–æ-—Ç–æ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç, –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏:

```bash
# –õ–æ–≥–∏ CUPS
sudo tail -f /var/log/cups/error_log

# –õ–æ–≥–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
# –ë—É–¥—É—Ç –≤ –∫–æ–Ω—Å–æ–ª–∏ –≥–¥–µ –∑–∞–ø—É—â–µ–Ω app.py
```
